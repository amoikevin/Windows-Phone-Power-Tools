<Window x:Class="WindowsPhonePowerTools.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:this="clr-namespace:WindowsPhonePowerTools"
        xmlns:metro="clr-namespace:MetroUI;assembly=MetroUI"
        xmlns:stock="clr-namespace:StockIcons"
        Title="Windows Phone Toolbox" Height="400" Width="550" MinHeight="400" MinWidth="550" ResizeMode="CanResizeWithGrip" WindowStyle="None" AllowsTransparency="True"
        Icon="wptools.ico"
        SourceInitialized="Window_SourceInitialized"
        Background="White">

    <Window.Resources>
        <this:FileTypeToIconConverter x:Key="FileTypeToIconConverter"></this:FileTypeToIconConverter>
        <this:StreamToBitmapImageConverter x:Key="StreamToBitmapImageConverter"></this:StreamToBitmapImageConverter>
        <this:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"></this:BoolToVisibilityConverter>

        <Style x:Key="DeviceInformationSeparator" TargetType="Separator">
            <Setter Property="Margin" Value="-10,3,-10,3"></Setter>
        </Style>

        <Style x:Key="MetroLink" TargetType="Hyperlink">
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Foreground" Value="Gray" />
                </Trigger>
            </Style.Triggers>
            <Setter Property="TextBlock.TextDecorations" Value="{x:Null}"></Setter>
            <Setter Property="Foreground" Value="Black"></Setter>
            <Setter Property="FontSize" Value="8"></Setter>
            <Setter Property="FontFamily" Value="Segoe UI, Verdana"></Setter>
            <Setter Property="Cursor" Value="Arrow"></Setter>
        </Style>

        <Style x:Key="MetroSmallHeader" TargetType="TextBlock">
            <Setter Property="FontSize" Value="10"></Setter>
            <Setter Property="FontWeight" Value="Bold"></Setter>
        </Style>

        <Style x:Key="DeviceInfoHeader" TargetType="TextBlock">
            <Setter Property="Margin" Value="0,0,12,0"></Setter>
        </Style>

        <DataTemplate x:Key="ItemTemplate">
            <TextBlock Text="{Binding}" Foreground="Red" />
        </DataTemplate>

        <DataTemplate x:Key="SelectedTemplate">
            <TextBlock Text="{Binding}" Foreground="White" />
        </DataTemplate>

        <Style TargetType="Button" x:Key="ConnectionIndicatorStyle">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <StackPanel Orientation="Horizontal">
                            <StackPanel Margin="0,5,0,0" Visibility="{Binding Device.Connected, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=True}">
                                <TextBlock FontFamily="Segoe WP" FontWeight="Bold" HorizontalAlignment="Right">NO DEVICE</TextBlock>
                                <TextBlock FontFamily="Segoe WP" FontWeight="Bold" FontSize="8" HorizontalAlignment="Right">CLICK TO CONNECT</TextBlock>
                            </StackPanel>
                            <StackPanel Margin="0,5,0,0" Visibility="{Binding Device.Connected, Converter={StaticResource BoolToVisibilityConverter}}">
                                <TextBlock HorizontalAlignment="Right" FontFamily="Segoe WP" FontWeight="Bold" Text="{Binding Device.CurrentDevice.Name}"></TextBlock>
                                <TextBlock HorizontalAlignment="Right" FontFamily="Segoe WP" FontWeight="Bold" Text="{Binding Device.DeviceType}"></TextBlock>
                            </StackPanel>
                            <Canvas Margin="6,0,0,0" Width="36" Height="36">
                                <Rectangle Height="36" Width="36" Fill="{Binding StatusColor}"></Rectangle>
                                <Image Source="/images/phone_logo.png" Height="30" Width="18" Canvas.Left="9" Canvas.Top="3"></Image>
                                <Rectangle Height="36" Width="36" x:Name="rectStatusHighlight" Visibility="Collapsed">
                                    <Rectangle.Fill>
                                        <SolidColorBrush Color="Gray" Opacity="0.4"></SolidColorBrush>
                                    </Rectangle.Fill>
                                </Rectangle>
                            </Canvas>
                        </StackPanel>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Foreground" Value="#a9a9a9"></Setter>
                                <Setter TargetName="rectStatusHighlight" Property="Visibility" Value="Visible"></Setter>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="ListBoxItem" x:Key="PivotHeaders">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ListBoxItem">
                        <TextBlock Name="TextBlock" Text="{TemplateBinding Content}" Foreground="LightGray" FontFamily="Segoe WP" FontSize="25" Margin="0,0,20,0" FontWeight="Thin"></TextBlock>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="TextBlock" Property="Foreground" Value="Gray"/>
                            </Trigger>

                            <Trigger Property="IsSelected" Value="true">
                                <Setter TargetName="TextBlock" Property="Foreground" Value="Black"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

    </Window.Resources>

    <Grid>

        <Grid.ColumnDefinitions>
            <ColumnDefinition></ColumnDefinition>
            <ColumnDefinition></ColumnDefinition>
        </Grid.ColumnDefinitions>

        <Grid.RowDefinitions>
            <RowDefinition Height="36"></RowDefinition>
            <!-- Zune Metro has 36px on the upper bar -->
            <RowDefinition Height="36"></RowDefinition>
            <RowDefinition Height="*"></RowDefinition>
        </Grid.RowDefinitions>

        <Rectangle Fill="White" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Column="0" Grid.ColumnSpan="2" Grid.Row="0" PreviewMouseDown="Rectangle_PreviewMouseDown"></Rectangle>

        <TextBlock Style="{StaticResource MetroSmallHeader}" Margin="0,3,0,0" Grid.Row="0" Grid.Column="0" HorizontalAlignment="Right">
            <Hyperlink Style="{StaticResource MetroLink}" Name="btnAbout" Click="btnAbout_Click">ABOUT</Hyperlink>
        </TextBlock>

        <StackPanel Orientation="Horizontal" Grid.Row="0" Grid.Column="1" HorizontalAlignment="Right" Margin="0,0,12,0" VerticalAlignment="Top">
            <Grid Margin="0,0,18,0" x:Name="gridConnectionIndicator">
                <Button Name="btnIndicator" Click="btnIndicator_Click" Style="{StaticResource ConnectionIndicatorStyle}">
                </Button>
            </Grid>
            <metro:ImageButton Image="/images/minimise.png" HoverImage="/images/minimise_highlighted.png" Height="8" Width="7" x:Name="btnMinimize" Click="btnMinimize_Click" Margin="0,0,6,0"/>
            <metro:ImageButton Image="/images/maximise.png" HoverImage="/images/maximise_highlighted.png" Height="8" Width="9" x:Name="btnMaximise" Click="btnMaximise_Click" Margin="0,0,6,0"/>
            <metro:ImageButton Image="/images/restore.png" HoverImage="/images/restore_highlighted.png" Height="9" Width="9" x:Name="btnRestore" Click="btnRestore_Click" Visibility="Collapsed" Margin="0,0,6,0"/>
            <metro:ImageButton Image="/images/exit.png" HoverImage="/images/exit_highlighted.png" Height="7" Width="8" x:Name="btnClose" Click="btnClose_Click"/>
        </StackPanel>

        <ListBox Grid.Row="1" Grid.ColumnSpan="2" ItemContainerStyle="{StaticResource PivotHeaders}" BorderThickness="0" Margin="12,0,0,0">
            <ListBox.ItemsPanel>
                <ItemsPanelTemplate>
                    <StackPanel Orientation="Horizontal"></StackPanel>
                </ItemsPanelTemplate>
            </ListBox.ItemsPanel>

            <ListBoxItem x:Name="headerInstall" Selected="headerInstall_Selected">install|update</ListBoxItem>
            <ListBoxItem x:Name="headerApps" Selected="headerApps_Selected">apps</ListBoxItem>
            <ListBoxItem x:Name="headerFileBrowser" Selected="headerFileBrowser_Selected">file browser</ListBoxItem>
        </ListBox>

        <Grid Grid.Row="2" Grid.ColumnSpan="2" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
            <Canvas x:Name="pivotInstall" IsEnabled="{Binding Device.Connected}" Visibility="Collapsed">
                <Grid>
                    <TextBox Height="22" HorizontalAlignment="Left" Margin="8,35,0,0" Name="txtXapFile" VerticalAlignment="Top" Width="364" />
                    <Button Content="Browse" Height="24" HorizontalAlignment="Left" Margin="378,35,0,0" Name="btnBrowse" VerticalAlignment="Top" Width="77" Click="btnBrowse_Click" />
                    <Button Content="Install" Height="24" HorizontalAlignment="Left" Margin="8,63,0,0" Name="btnInstall" VerticalAlignment="Top" Width="77" Click="btnInstall_Click" />
                    <Button Content="Update" Height="24" HorizontalAlignment="Left" Margin="104,63,0,0" Name="btnUpdate" VerticalAlignment="Top" Width="77" Click="btnUpdate_Click" />
                    <TextBlock Height="23" HorizontalAlignment="Left" Margin="8,15,0,0" Name="textBlock1" VerticalAlignment="Top" Width="340">XAP Path (separate multiple files with a semi-colon (;) ):</TextBlock>
                    <TextBlock Height="81" HorizontalAlignment="Left" Margin="8,97,0,0" Name="textBlock2" TextWrapping="Wrap" VerticalAlignment="Top" Width="488">
                        &#8226; Failures are silent - Updating a xap that is not already installed will have no effect<LineBreak/>
                        &#8226; Installing a xap that already exists will wipe the existing installation and reinstall the xap
                    </TextBlock>
                </Grid>
            </Canvas>
            <Canvas x:Name="pivotApps" IsEnabled="{Binding Device.Connected}" Visibility="Collapsed">
                <Canvas>
                    <TextBlock Margin="6,11,349,243" Style="{StaticResource MetroSmallHeader}" Canvas.Top="1">INSTALLED APPS</TextBlock>
                    <ListBox Height="235" HorizontalAlignment="Left" Margin="6,32,0,0" Name="lstInstalledApps" VerticalAlignment="Top" Width="242" ItemsSource="{Binding Device.InstalledApplications}" SelectedItem="{Binding CurSelectedInstalledApp, Mode=TwoWay}" Canvas.Top="-2">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal" Margin="0,1.5,0,1.5">
                                    <Image Height="20" Width="20" Margin="0,0,4,0" Source="{Binding Icon, Converter={StaticResource StreamToBitmapImageConverter}}"></Image>
                                    <TextBlock Text="{Binding Name}"></TextBlock>
                                </StackPanel>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                    <StackPanel Canvas.Left="260" Canvas.Top="30">
                        <TextBlock Height="20" Text="GUID" Style="{StaticResource MetroSmallHeader}" />
                        <TextBlock Height="22" Name="txtAppGuid" Width="232" Text="{Binding CurSelectedInstalledApp.RemoteApplication.ProductID}" />
                        <TextBlock Height="20" Text="NAME" Style="{StaticResource MetroSmallHeader}" />
                        <TextBox Height="22" Name="txtAppName" Width="232" Text="{Binding CurSelectedInstalledApp.Name, Mode=TwoWay}" />
                        <TextBlock TextWrapping="Wrap" Width="250">App names cannot be read off the device and are populated when you install an app. You can change an app name by editing it above.</TextBlock>
                    </StackPanel>
                    <GroupBox Canvas.Left="254" Canvas.Top="203" Header="ACTIONS" FontWeight="Bold" FontSize="10" Height="62" Width="246">
                        <Canvas>
                            <Button Content="Uninstall" Height="23" Name="btnUninstall" Width="65" Click="btnUninstall_Click" Canvas.Left="7" Canvas.Top="6" />
                            <Button Content="Launch" Height="23" x:Name="btnLaunchApp" Click="btnLaunchApp_Click" Canvas.Left="89" Canvas.Top="6" Width="60"></Button>
                            <Button Content="Kill" Height="23" x:Name="btnKillApp" Click="btnKillApp_Click" Canvas.Left="164" Canvas.Top="6" Width="60"></Button>
                        </Canvas>
                    </GroupBox>
                </Canvas>
                <TextBlock Canvas.Left="7" Canvas.Top="280">Note: App names will appear as GUIDs unless they have been installed or updated with this tool</TextBlock>
            </Canvas>
            <Grid x:Name="pivotFileBrowser" IsEnabled="{Binding Device.Connected}" Visibility="Collapsed" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                <Grid.RowDefinitions>
                    <RowDefinition Height="5"></RowDefinition>
                    <RowDefinition Height="280*"></RowDefinition>
                    <RowDefinition Height="40"></RowDefinition>
                    <RowDefinition Height="30"></RowDefinition>
                    <RowDefinition Height="30*"></RowDefinition>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="390*"></ColumnDefinition>
                    <ColumnDefinition Width="Auto"></ColumnDefinition>
                </Grid.ColumnDefinitions>

                <TreeView Grid.Row="1" Grid.Column="0" Margin="6,0,10,0" MinHeight="210" MinWidth="365" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" x:Name="treeIsoStore" SelectedItemChanged="treeIsoStore_SelectedItemChanged" ItemsSource="{Binding Device.RemoteIsoStores}" TreeViewItem.Expanded="treeIsoStore_Expanded">
                    <TreeView.ItemContainerStyle>
                        <Style TargetType="{x:Type TreeViewItem}">
                            <EventSetter Event="MouseDoubleClick" Handler="treeIsoStoreItem_OnDoubleClick"></EventSetter>
                            <EventSetter Event="KeyUp" Handler="treeIsoStoreItem_OnKeyUp"></EventSetter>
                            <Setter Property="AllowDrop" Value="True"></Setter>
                            <EventSetter Event="Drop" Handler="treeIsoStoreItem_OnDrop"></EventSetter>
                            <EventSetter Event="MouseMove" Handler="treeIsoStoreItem_OnMouseMove"></EventSetter>
                        </Style>
                    </TreeView.ItemContainerStyle>
                    <TreeView.ItemTemplate>
                        <HierarchicalDataTemplate ItemsSource="{Binding Children}">
                            <StackPanel Orientation="Horizontal">
                                <StackPanel.ContextMenu>
                                    <ContextMenu>
                                    <MenuItem Header="Refresh" x:Name="btnRefresh" Click="btnRefresh_Click" />
                                    <MenuItem Header="Launch" x:Name="btnLaunchMenu" Click="btnLaunchMenu_Click"/>
                                    </ContextMenu>
                                </StackPanel.ContextMenu>
                                <Image Height="16" Width="16" Source="{Binding Icon, Converter={StaticResource FileTypeToIconConverter}}" Margin="0,1,5,3"></Image>
                                <TextBlock Text="{Binding Name}"></TextBlock>
                            </StackPanel>
                        </HierarchicalDataTemplate>
                    </TreeView.ItemTemplate>
                    <!--<TreeView.ContextMenu>
                        <ContextMenu>
                        </ContextMenu>
                    </TreeView.ContextMenu>-->
                </TreeView>
                <StackPanel Grid.Row="1" Grid.Column="1" Grid.RowSpan="3" x:Name="stackFileProperties" Width="145">
                    <TextBlock Height="19" Text="CREATED" Style="{StaticResource MetroSmallHeader}" />
                    <TextBlock Height="23" Text="{Binding CreationTime}" />
                    <TextBlock Height="19" Text="ATTRIBUTES" Style="{StaticResource MetroSmallHeader}" />
                    <TextBlock Height="23" Text="{Binding FileAttribute}" />
                    <TextBlock Height="19" Text="LAST ACCESSED" Style="{StaticResource MetroSmallHeader}" />
                    <TextBlock Height="23" Text="{Binding LastWriteTime}" />
                    <TextBlock Height="19" Text="LAST WRITE" Style="{StaticResource MetroSmallHeader}" />
                    <TextBlock Height="23" Text="{Binding LastAccessTime}" />
                    <TextBlock Height="19" Text="SIZE" Style="{StaticResource MetroSmallHeader}" />
                    <TextBlock Height="23" Text="{Binding Length}" />
                </StackPanel>
                
                <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,5,0,0">
                    <Button Content="Get" Height="24" Name="btnGet" Width="77" Click="btnGet_Click" Margin="10,0,10,0" />
                    <Button Content="Put File" Height="24" Name="btnPutFile" Width="77" Click="btnPutFile_Click" Margin="0,0,10,0" />
                    <Button Content="Put Directory" Height="24" Name="btnPutDirectory" Width="92" Click="btnPutDirectory_Click" Margin="0,0,10,0" />
                    <Button Content="Delete" Height="24" Name="btnDelete" Width="77" Click="btnDelete_Click" />
                </StackPanel>
                
                <CheckBox Grid.Row="3" Canvas.Left="7" Margin="5,0,0,0" Content="Overwrite Existing" Height="16" Name="chkOverwrite" />

                <TextBlock Grid.Row="4" Grid.ColumnSpan="2" Margin="5,0,0,0">Note: App names will appear as GUIDs unless they have been installed or updated with this tool</TextBlock>
            </Grid>
        </Grid>

        <metro:MetroDialog x:Name="dialogError" Visibility="Collapsed" Grid.ColumnSpan="2" Grid.RowSpan="3" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
            <Canvas>
                <Image Source="/images/error.png" Height="48" Width="48" Canvas.Left="5"></Image>
                <TextBlock FontSize="20" FontWeight="Bold" Canvas.Left="54" Canvas.Top="12">Oh Oh! An error has occurred</TextBlock>
                <TextBlock Canvas.Left="16" Canvas.Top="55" Height="144" Width="370" Text="{Binding ErrorString}" FontSize="16" TextWrapping="Wrap"></TextBlock>
                <Button x:Name="btnDismissErrorDialog" Content="OK" Click="btnDismissErrorDialog_Click" Height="22" Width="73" FontFamily="Segoe WP" Canvas.Left="311" Canvas.Top="206"></Button>
            </Canvas>
        </metro:MetroDialog>

        <metro:MetroDialog x:Name="dialogConnect" Visibility="Visible" Grid.ColumnSpan="2" Grid.RowSpan="3" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" DataContext="{Binding Device}">
            <Canvas>
                <TextBlock Margin="23,30,428,0" Height="18" VerticalAlignment="Top" Canvas.Left="-5" Canvas.Top="-17">Connect to:</TextBlock>
                <ComboBox Canvas.Left="85" Canvas.Top="12" ItemsSource="{Binding Devices}" SelectedItem="{Binding CurrentDevice, Mode=TwoWay}" HorizontalAlignment="Right" Width="293">
                    <ComboBox.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Name}"></TextBlock>
                        </DataTemplate>
                    </ComboBox.ItemTemplate>
                </ComboBox>
                <Button x:Name="btnConnect" Content="CONNECT" Click="btnConnect_Click" Height="22" Width="73" FontFamily="Segoe WP" Canvas.Left="306" Canvas.Top="36"></Button>

                <StackPanel Orientation="Horizontal" Height="40" Width="282" Canvas.Left="18" Canvas.Top="36" Visibility="{Binding IsError, Converter={StaticResource BoolToVisibilityConverter}}">
                    <Image Source="/images/error.png" Height="48" Width="24" VerticalAlignment="Top"></Image>
                    <TextBlock Text="{Binding StatusMessage}" VerticalAlignment="Stretch" TextWrapping="Wrap" Foreground="Red" Width="250" Margin="8,0,0,0"></TextBlock>
                </StackPanel>

                <StackPanel Orientation="Horizontal" Height="40" Width="282" Canvas.Left="18" Canvas.Top="36" Visibility="{Binding Connected, Converter={StaticResource BoolToVisibilityConverter}}">
                    <Image Source="/images/connected.png" Height="48" Width="27" VerticalAlignment="Top"></Image>
                    <TextBlock Text="{Binding StatusMessage}" HorizontalAlignment="Stretch" Margin="8,0,0,0" VerticalAlignment="Stretch" TextWrapping="Wrap" Foreground="Green" Canvas.Left="18" Canvas.Top="36"></TextBlock>
                </StackPanel>

                <StackPanel x:Name="stackElevatedButton" Orientation="Horizontal" Canvas.Top="-10" Canvas.Left="292">
                    <Image Source="{x:Static stock:StockIcons.Shield}" Height="10" Width="10"/>
                    <TextBlock Style="{StaticResource MetroSmallHeader}" VerticalAlignment="Center" Visibility="{Binding IsElevated, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=True}">
                        <Hyperlink Style="{StaticResource MetroLink}" Name="btnLaunchElevated" Click="btnLaunchElevated_Click">LAUNCH ELEVATED</Hyperlink>
                    </TextBlock>
                    <TextBlock Margin="4,0,0,0" Style="{StaticResource MetroSmallHeader}" FontSize="8" VerticalAlignment="Center" Visibility="{Binding IsElevated, Converter={StaticResource BoolToVisibilityConverter}}" Foreground="Red">
                        ELEVATED
                    </TextBlock>
                </StackPanel>

                <Expander Height="154" Header="DEVICE INFORMATION" FontWeight="Bold" HorizontalAlignment="Left" Canvas.Top="77" Canvas.Left="19">
                    <ScrollViewer Height="130" Width="352" FontWeight="Regular">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Style="{StaticResource DeviceInfoHeader}" Text="Platform" />
                                <TextBlock Style="{StaticResource DeviceInfoHeader}" Text="OS Build No" />
                                <TextBlock Style="{StaticResource DeviceInfoHeader}" Text="OS Version Major" />
                                <TextBlock Style="{StaticResource DeviceInfoHeader}" Text="OS Version Major" />
                                <Separator Style="{StaticResource DeviceInformationSeparator}" />
                                <TextBlock Style="{StaticResource DeviceInfoHeader}" Text="Architecture" />
                                <TextBlock Style="{StaticResource DeviceInfoHeader}" Text="Instruction Set" />
                                <TextBlock Style="{StaticResource DeviceInfoHeader}" Text="Processors" />
                                <Separator Style="{StaticResource DeviceInformationSeparator}" />
                                <TextBlock Style="{StaticResource DeviceInfoHeader}" Text="Device Time" />
                                <TextBlock Style="{StaticResource DeviceInfoHeader}" Text="Default Locale" />
                                <Separator Style="{StaticResource DeviceInformationSeparator}" />
                                <TextBlock Style="{StaticResource DeviceInfoHeader}" Text="Available Memory" />
                                <TextBlock Style="{StaticResource DeviceInfoHeader}" Text="Available Virtual" />
                                <TextBlock Style="{StaticResource DeviceInfoHeader}" Text="Page Size" />
                                <TextBlock Style="{StaticResource DeviceInfoHeader}" Text="Page File Size" />
                                <TextBlock Style="{StaticResource DeviceInfoHeader}" Text="Total Memory" />
                                <TextBlock Style="{StaticResource DeviceInfoHeader}" Text="Total Virtual" />
                                <Separator Style="{StaticResource DeviceInformationSeparator}" />
                                <TextBlock Style="{StaticResource DeviceInfoHeader}" Text="Charging" />
                                <TextBlock Style="{StaticResource DeviceInfoHeader}" Text="Full Battery Lifetime" />
                                <TextBlock Style="{StaticResource DeviceInfoHeader}" Text="Battery %" />
                            </StackPanel>
                            <StackPanel Grid.Column="1">
                                <TextBlock Text="{Binding CurrentDevice.Platform.Name}" VerticalAlignment="Top" />
                                <TextBlock Text="{Binding SystemInfo.OSBuildNo}" />
                                <TextBlock Text="{Binding SystemInfo.OSMajor}" />
                                <TextBlock Text="{Binding SystemInfo.OSMinor}" />
                                <Separator Style="{StaticResource DeviceInformationSeparator}" />
                                <TextBlock Text="{Binding SystemInfo.ProcessorArchitecture}" />
                                <TextBlock Text="{Binding SystemInfo.InstructionSet}" />
                                <TextBlock Text="{Binding SystemInfo.NumberOfProcessors}" />
                                <Separator Style="{StaticResource DeviceInformationSeparator}" />
                                <TextBlock Text="{Binding SystemInfo.CurrentTime}" />
                                <TextBlock Text="{Binding SystemInfo.SystemDefaultLocaleId}" />
                                <Separator Style="{StaticResource DeviceInformationSeparator}" />
                                <TextBlock Text="{Binding SystemInfo.AvailPhys}" />
                                <TextBlock Text="{Binding SystemInfo.AvailVirtual}" />
                                <TextBlock Text="{Binding SystemInfo.PageSize}" />
                                <TextBlock Text="{Binding SystemInfo.TotalPageFile}" />
                                <TextBlock Text="{Binding SystemInfo.TotalPhys}" />
                                <TextBlock Text="{Binding SystemInfo.TotalVirtual}" />
                                <Separator Style="{StaticResource DeviceInformationSeparator}" />
                                <TextBlock Text="{Binding SystemInfo.ACLineStatus}" />
                                <TextBlock Text="{Binding SystemInfo.BatteryFullLifetime}" />
                                <TextBlock Text="{Binding SystemInfo.BatteryLifePercent}" />
                            </StackPanel>
                        </Grid>
                    </ScrollViewer>
                </Expander>
            </Canvas>
        </metro:MetroDialog>

        <metro:MetroDialog x:Name="dialogAbout" Visibility="Collapsed" Grid.ColumnSpan="2" Grid.RowSpan="3" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
            <Canvas>
                <StackPanel Orientation="Horizontal" Canvas.Left="20">
                    <Image Source="wptools.ico"></Image>
                    <TextBlock VerticalAlignment="Center" FontFamily="Segoe WP" FontSize="25" Margin="10,0,0,0" FontWeight="Thin">Windows Phone Power Tools</TextBlock>
                </StackPanel>

                <StackPanel Canvas.Left="20" Canvas.Top="40">
                    <TextBlock>
                        <Hyperlink x:Name="linkWebsite" NavigateUri="http://wptools.codeplex.com" Click="linkWebsite_Click">http://wptools.codeplex.com</Hyperlink>
                    </TextBlock>
                    <TextBlock FontSize="10">
                        COPYRIGHT (C) 2011 OREN NACHMAN<LineBreak/>
                        LICENSED UNDER THE Ms-Pl
                    </TextBlock>
                </StackPanel>

                <TextBlock Style="{StaticResource MetroSmallHeader}" Canvas.Left="20" Canvas.Top="90">CHANGELOG</TextBlock>
                <ScrollViewer Height="125" Width="364" FontWeight="Regular" Margin="0,6,0,0" Canvas.Top="100" Canvas.Left="20">

                    <StackPanel Margin="0,0,5,0">
                        <Separator Margin="0,5,0,5"></Separator>

                        <TextBlock Style="{StaticResource MetroSmallHeader}" Margin="0,0,0,5">VERSION 1.4.9.1 - 7/12/2011</TextBlock>
                        <TextBlock TextWrapping="Wrap">
                            &#x2022; Minor bug fix: BUG 14: any mouse button click, except left click, on the window drag area would cause a crash (Thanks Doug!)
                        </TextBlock>
                        
                        <Separator Margin="0,5,0,5"></Separator>

                        <TextBlock Style="{StaticResource MetroSmallHeader}" Margin="0,0,0,5">VERSION 1.4.9 - 27/11/2011</TextBlock>
                        <TextBlock TextWrapping="Wrap">
                            &#x2022; Support Windows XP (requested by Sergoreg, Thanks!)
                        </TextBlock>

                        <Separator Margin="0,5,0,5"></Separator>

                        <TextBlock Style="{StaticResource MetroSmallHeader}" Margin="0,0,0,5">VERSION 1.4.8 - 13/11/2011</TextBlock>
                        <TextBlock TextWrapping="Wrap">
                            &#x2022; BUG #12: Fixed NullReferenceException on xaps that claim that have icons, but don't actually have the icon in the xap<LineBreak/>
                            &#x2022; BUG: Fixed a bug affecting the initial positioning of the left shadow<LineBreak/>
                        </TextBlock>

                        <Separator Margin="0,5,0,5"></Separator>

                        <TextBlock Style="{StaticResource MetroSmallHeader}" Margin="0,0,0,5">VERSION 1.4.7 - 3/11/2011</TextBlock>
                        <TextBlock TextWrapping="Wrap">
                            &#x2022; BUG: Fixed opening a file from File Browser with double click (using "openas" caused only 
                                     unrecognised files to work, while recognised file types were ignored)<LineBreak/>
                            &#x2022; You can now navigate the File Browser with the keyboard, hitting Enter will open a file
                                     similar to double click<LineBreak/>
                            &#x2022; Shadow windows will no longer appear in Alt+Tab
                        </TextBlock>

                        <Separator Margin="0,5,0,5"></Separator>

                        <TextBlock Style="{StaticResource MetroSmallHeader}" Margin="0,0,0,5">VERSION 1.4.6 - 1/11/2011</TextBlock>
                        <TextBlock TextWrapping="Wrap">
                            &#x2022; Added Maximise / Minimise / Restore buttons to go along with the window that can be resized
                        </TextBlock>

                        <Separator Margin="0,5,0,5"></Separator>

                        <TextBlock Style="{StaticResource MetroSmallHeader}" Margin="0,0,0,5">VERSION 1.4.5 - 1/11/2011</TextBlock>
                        <TextBlock TextWrapping="Wrap">
                            &#x2022; Window can now be resized, only really useful in the file browser<LineBreak/>
                            &#x2022; Different shadows. If you're interested in why, read the comment in WindowShadow.cs<LineBreak/>
                            &#x2022; Fixed a typo. Took longer to write this line.
                        </TextBlock>

                        <Separator Margin="0,5,0,5"></Separator>

                        <TextBlock Style="{StaticResource MetroSmallHeader}" Margin="0,0,0,5">VERSION 1.4 - 31/10/2011</TextBlock>
                        <TextBlock TextWrapping="Wrap">
                            &#x2022; Added Drag &amp; Drop support, you can now drag files to and from the file browser (for example,
                            you can drag a file into Explorer to download it to your machine instead of using the buttons, and vice versa)<LineBreak/>
                            &#x2022; You can even drag &amp; drop between apps in IsolatedStorage (right in the browser)<LineBreak/>
                            &#x2022; We now use the "openas" verb when double clicking on a file in the file browser, which means that Windows
                            will prompt you for a program to use to view unrecognised files.<LineBreak/>
                            &#x2022; New icon.
                        </TextBlock>

                        <Separator Margin="0,5,0,5"></Separator>

                        <TextBlock Style="{StaticResource MetroSmallHeader}" Margin="0,0,0,5">VERSION 1.3.3 - 12/10/2011</TextBlock>
                        <TextBlock TextWrapping="Wrap">
                            &#x2022; BUG #10: Added message specific to missing methods from CoreCon<LineBreak/>
                            &#x2022; Fixed visual glitch with thin white lines on either side of button text
                        </TextBlock>

                        <Separator Margin="0,5,0,5"></Separator>

                        <TextBlock Style="{StaticResource MetroSmallHeader}" Margin="0,0,0,5">VERSION 1.3.2 - 11/10/2011</TextBlock>
                        <TextBlock TextWrapping="Wrap">
                            &#x2022; BUG #9: eliminate MessageBox flood when triggering recursive exceptions.
                        </TextBlock>

                        <Separator Margin="0,5,0,5"></Separator>

                        <TextBlock Style="{StaticResource MetroSmallHeader}" Margin="0,0,0,5">VERSION 1.3.1 - 27/9/2011</TextBlock>
                        <TextBlock TextWrapping="Wrap">
                            &#x2022; BUG #6: when double clicking on a file we should always overwrite to make sure sure we don't get stale files (thanks Gordon!)
                        </TextBlock>

                        <Separator Margin="0,5,0,5"></Separator>

                        <TextBlock Style="{StaticResource MetroSmallHeader}" Margin="0,0,0,5">VERSION 1.3 - 27/9/2011</TextBlock>
                        <TextBlock TextWrapping="Wrap">
                            &#x2022; You can now edit app names. Especially useful for Apps with GUIDs for names (since we can't read app names from the device)
                        </TextBlock>

                        <Separator Margin="0,5,0,5"></Separator>

                        <TextBlock Style="{StaticResource MetroSmallHeader}" Margin="0,0,0,5">VERSION 1.2.2 - 22/9/2011</TextBlock>
                        <TextBlock TextWrapping="Wrap">
                            &#x2022; More human readable exception messages for SmartDeviceExceptions
                        </TextBlock>

                        <Separator Margin="0,5,0,5"></Separator>

                        <TextBlock Style="{StaticResource MetroSmallHeader}" Margin="0,0,0,5">VERSION 1.2.1 - 21/9/2011</TextBlock>
                        <TextBlock TextWrapping="Wrap">
                            &#x2022; User Request: Added option in Connection dialog to elevate current process so that you can use the tools to connect to
                                     an elevated emulator (usually launched from an elevated VS).<LineBreak/>
                            &#x2022; Lowered minimum supported build to 7600 to support users who still haven't upgraded to the RC SDK
                        </TextBlock>

                        <Separator Margin="0,5,0,5"></Separator>

                        <TextBlock Style="{StaticResource MetroSmallHeader}" Margin="0,0,0,5">VERSION 1.2 - 20/9/2011</TextBlock>
                        <TextBlock TextWrapping="Wrap">
                            &#x2022; Added more detailed message in the unexpected unhandled exception message<LineBreak/>
                            &#x2022; Added note about app names that appear as GUIDs<LineBreak/>
                            &#x2022; UI tweaks &amp; slight string changes for connection errors<LineBreak/>
                        </TextBlock>

                        <Separator Margin="0,5,0,5"></Separator>

                        <TextBlock Style="{StaticResource MetroSmallHeader}" Margin="0,0,0,5">VERSION 1.1 - 19/9/2011</TextBlock>
                        <TextBlock>&#x2022; UI revamp to a Metro style</TextBlock>
                        <TextBlock TextWrapping="Wrap">&#x2022; FIXED BUG #1: Uploaded files / directories go to the correct location and the view is refreshed after upload</TextBlock>
                        <TextBlock TextWrapping="Wrap">&#x2022; Added force refresh option to right click menu on file list</TextBlock>
                        <TextBlock TextWrapping="Wrap">&#x2022; Miscellaneous tweaks to the exception and connection error handling features to provide more descriptive error messages to the user</TextBlock>

                        <Separator Margin="0,5,0,5"/>

                        <TextBlock Style="{StaticResource MetroSmallHeader}" Margin="0,0,0,5">VERSION 1.0 - 13/9/2011</TextBlock>
                        <TextBlock TextWrapping="Wrap">&#x2022; Initial release</TextBlock>
                        <TextBlock TextWrapping="Wrap">&#x2022; Update developer xaps</TextBlock>
                        <TextBlock TextWrapping="Wrap">&#x2022; Install / Update multiple xaps in unison</TextBlock>
                        <TextBlock TextWrapping="Wrap">&#x2022; Browse the IsolatedStorage structure of your developer xaps</TextBlock>
                        <TextBlock TextWrapping="Wrap">&#x2022; Download individual files or whole directory structures</TextBlock>
                        <TextBlock TextWrapping="Wrap">&#x2022; Upload files and directories to your developer xaps - great for snapshotting IsolatedStorage at different times and testing update scenarios</TextBlock>
                    </StackPanel>
                </ScrollViewer>
            </Canvas>
        </metro:MetroDialog>
    </Grid>
</Window>
